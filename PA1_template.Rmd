---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

The data should be placed in */home/remco/Desktop/data/* folder to work.
For processing I also import some libraries.

```{r load_data}

library(lubridate)
library(stringr)
library(dplyr)
library(lattice)

d <- read.csv("/home/remco/Desktop/data/activity.csv")

```

Adding *datetime* and *day* values. The latter will be used to distinguish weekdays (Monday-Friday) from weekend-days (Saturday and Sunday).

```{r adding_datetime_values}
d$datetime      <- ymd_hm(paste(d$date, str_pad(d$interval,4, pad="0"), sep=" "))
d$day           <- wday(d$datetime)
d               <- mutate(d, day = factor(1*(day==1|day==7), labels=c("weekday","weekend")))
```

Get a short overview of the data.frame to see what's in there.

```{r check_frame}
str(d)
```




## What is mean total number of steps taken per day?

Now grouping over *date* value in order to calculate the total number of steps
per day. A histogram is created to plot the frequency against number of steps.

```{r steps_per_day}

days            <- group_by(d, date)
steps_per_day   <- summarize(days, total_steps = sum(steps, na.rm=TRUE))
hist(steps_per_day$total_steps, breaks=30, col="blue", 
     xlab="number of steps per day",
     main="")

mean_value      <- mean(steps_per_day$total_steps, na.rm=TRUE)
median_value    <- median(steps_per_day$total_steps, na.rm=TRUE)
```

It follows that  *mean_value*=`r mean_value` and *median_value*=`r median_value`. 




## What is the average daily activity pattern?

In order to retrieve the average daily activity pattern we need to group by *interval*, thereby summarizing over equal intervals of all recorded dates. The resulting pattern
is plotted using *xyplot*.

```{r daily_activity}

intervals       <- group_by(d, interval)
activity        <- summarize(intervals, steps = mean(steps, na.rm=TRUE))

with(activity, xyplot( steps ~ interval, type="l", col="blue", 
                       lwd=2, main="Daily activity pattern"))

```

The top three intervals in terms of activity (number of steps), looks as follows:

```{r most_activity}

head( arrange( activity, -steps) , 3 )

```



## Imputing missing values


First <NA> values are in the data.frame:

```{r counting_missing}

na      <- is.na( d )
na_sum  <- apply( na , 2 , sum )
na_sum

```

It follows that only the *steps* value has missing values, this should not come as a surprise as this is the only measurement! A total number of `r na_sum[1]` measurements
are missing.


## Are there differences in activity patterns between weekdays and weekends?
